unit Configuracoes;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, ComCtrls, Buttons, ExtCtrls, IniFiles;

type
  TTConfig = class(TForm)
    FiltroRelCliente: TPanel;
    Panel1: TPanel;
    btnSalvar: TBitBtn;
    btnCancelar: TBitBtn;
    PageControl1: TPageControl;
    pgCliente: TTabSheet;
    pgProduto: TTabSheet;
    GroupBox1: TGroupBox;
    ckbCpf: TCheckBox;
    ckbRg: TCheckBox;
    GroupBox2: TGroupBox;
    ckbContato: TCheckBox;
    ckbCnpj: TCheckBox;
    TabSheet1: TTabSheet;
    GroupBox3: TGroupBox;
    ckbValidade: TCheckBox;
    TabSheet2: TTabSheet;
    GroupBox4: TGroupBox;
    CheckBox1: TCheckBox;
    CheckBox3: TCheckBox;
    GroupBox5: TGroupBox;
    CheckBox4: TCheckBox;
    CheckBox5: TCheckBox;
    CheckBox6: TCheckBox;
    GroupBox6: TGroupBox;
    CheckBox7: TCheckBox;
    CheckBox8: TCheckBox;
    CheckBox9: TCheckBox;
    procedure btnSalvarClick(Sender: TObject);
    procedure btnCancelarClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure FormKeyDown(Sender: TObject; var Key: Word; Shift: TShiftState);
  private
    { Private declarations }
    Ini : TIniFile;
  //Config de Cadastro de cliente
    rg : boolean;
    cpf : boolean;
  //Config de cadastro de Fornecedores
    Forcnpj : Boolean;
    Forcontato : Boolean;
  //Config de Cadastro de produto
    ProdVal : Boolean;
  public
    { Public declarations }
    procedure Chamatela;
  end;

var
  TConfig: TTConfig;

implementation

uses
 Funcoes;

{$R *.dfm}

procedure TTConfig.btnCancelarClick(Sender: TObject);
begin
  Close;
end;

procedure TTConfig.btnSalvarClick(Sender: TObject);
begin
  //procedimento de escrita no arquivo .ini

  //Config de Cliente
  ini.WriteBool('Cliente','rg',ckbRg.Checked);
  ini.WriteBool('Cliente','cpf',ckbCpf.Checked);
  //Config de Fornecedor
  ini.WriteBool('Fornecedor','cnpj',ckbCnpj.Checked);
  ini.WriteBool('Fornecedor','contato',ckbContato.Checked);
  //Config de Produto
  ini.WriteBool('Produto','val', ckbValidade.Checked);

  EnviaMensagem('Configurações foram salvas!','',mtInformation, [mbOK]);
  Close;
end;

procedure TTConfig.Chamatela;
begin
  TConfig := TTConfig.Create(Application);
  with TConfig do
  begin
    ShowModal;
  end;
  FreeAndNil(TConfig);
end;

procedure TTConfig.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  Ini.Free;
end;

procedure TTConfig.FormCreate(Sender: TObject);
begin
  //carrega arquivo .ini
  ini := TIniFile.Create('D:\FOCUS\Ini\ConfigPrjEstagio.ini');

  //carrega informações de cliente
  if ini.ReadBool('Cliente','rg', rg) = True then
    ckbRg.Checked := True;
  if ini.ReadBool('Cliente','cpf', cpf) = True then
    ckbCpf.Checked := True;

  //carrega informações de Fornecedores
  if ini.ReadBool('Fornecedor','cnpj', Forcnpj) = True then
    ckbCnpj.Checked := True;
  if ini.ReadBool('Fornecedor','contato', Forcontato) = True then
    ckbContato.Checked := True;

  //carrega informações de Produtos
  if ini.ReadBool('Produto','val', ProdVal) then
    ckbValidade.Checked := True;

end;

procedure TTConfig.FormKeyDown(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
  case key of
    VK_ESCAPE:
    begin
      if (btnCancelar.Visible) and (btnCancelar.Enabled) then
        btnCancelar.Click;
    end;
    VK_F5:
    begin
      if (btnSalvar.Visible) and (btnSalvar.Enabled) then
        btnSalvar.Click;
    end;
  end;
end;

end.
